
pipeline{
  agent any
  stages{
    stage('CI'){
      steps{
        script {
            doDynamicParallelSteps()
        }
      }
    }
  }
}

def doDynamicParallelSteps(){
  def cust = ["sdfg","kiuyfcvbn","sdfgfgh","zfhj"]
  tests = [:]
  for (f in cust) {
    tests["${f}"] = {
      node {
        stage("${f}") {
          echo '${f}'
        }
        stage("gjyjguig") {
          echo '${f} uihuoho'
        }
      }
    }
  }
  parallel tests
}
